<%= render 'nav_courses' %>

<div class="ui attached segment">
  <%= render 'search_form' %>
</div>

<table class="ui bottom attached table">
  <thead>
  <tr>
    <th><%= Course.human_attribute_name(:id) %></th>
    <th>
      <%= link_to Course.human_attribute_name(:title), filter_params('course.title-asc': 2, except: ['course.title-asc']) %>
    </th>
    <th><%= Course.human_attribute_name(:lecturer) %></th>
    <th><%= Course.human_attribute_name(:type) %></th>
    <th><%= Course.human_attribute_name(:course_taxon) %></th>
    <th><%= CourseMember.human_attribute_name(:state) %></th>
  </tr>
  </thead>
  
  <tbody>
  <% @course_members.each do |course_member| %>
    <tr>
      <td><%= course_member.course_id %></td>
      <td>
        <%= link_to course_member.course.title, my_course_path(course_member.course_id) %>
        <span class="<%= active_assert(course_member.course.compulsory, expected: 'ui green label', unexpected: 'ui label') %>"><%= course_member.course.compulsory_i18n %></span>
      </td>
      <td><%= course_member.course.lecturer&.name %></td>
      <td><%= course_member.course.type_i18n %></td>
      <td><%= course_member.course.course_taxon&.name %></td>
      <td>
        <span class="ui label"><%= course_member.state_i18n %></span>
        <% if course_member.in_studying? %>
          <%= link_to 'Quit', quit_my_course_member_path(course_member), remote: true %>
        <% else %>
          <span><%= course_member.score %></span>
        <% end %>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>

<%= paginate @course_members %>

<div id="course_member_modal"></div>
